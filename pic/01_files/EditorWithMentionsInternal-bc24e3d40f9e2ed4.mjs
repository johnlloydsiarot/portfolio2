(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[35978],{199324:(e,t,n)=>{n.d(t,{Z:()=>o});const o=["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto","Oxygen-Sans","Ubuntu","Cantarell",'"Fira Sans"','"Droid Sans"','"Helvetica Neue"',"Helvetica",'"ãƒ’ãƒ©ã‚®ãƒŽè§’ã‚´ Pro W3"','"Hiragino Kaku Gothic Pro"',"ãƒ¡ã‚¤ãƒªã‚ª","Meiryo",'"ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")},391254:(e,t,n)=>{n.d(t,{Z:()=>s});n(441143);var o=n(785893);class r{static factory(e){return e instanceof r?e:new r(String(e))}constructor(e){this._private_safe_value=e.trim().replace(">",">").replace("<","<").replace("&","&").replace('"','"').replace("'","'")}toString(){return this._private_safe_value}}function s(e){const{css:t,unsafeCSS:n,...s}=e,i=String(t||"")||n||"";return!!i?(0,o.jsx)("style",{...s,dangerouslySetInnerHTML:{__html:String(r.factory(i))}}):null}},941646:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(883119),r=n(785893);function s(e){const{children:t,display:n,id:s}=e;return(0,r.jsx)(o.xu,{"data-test-id":s,display:n,children:t})}},367216:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(667294),r=n(391254),s=n(898781),i=n(883119),a=n(785893);function l({entryPointRef:e,isEmojiTrayOpen:t,onClick:n}){const[l,c]=(0,o.useState)(!1),u=(0,i.JZ)(),d=(0,s.ZP)(),p=l&&!u?{fontSize:"24px",animationName:"wiggle",animationDuration:"0.9s"}:{fontSize:"24px"};return(0,a.jsx)(i.xu,{display:"flex",justifyContent:"center",color:t?"secondary":"transparent",rounding:"circle",children:(0,a.jsxs)(i.iP,{accessibilityLabel:d._('Select an emoji', 'emojitray.button.accessibilityLabel', 'Accessibility label for emoji tray button'),rounding:"circle",onTap:()=>{null==n||n()},fullWidth:!1,onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:[(0,a.jsx)(r.Z,{unsafeCSS:"@keyframes wiggle {\n        0% {transform: rotate(0deg);}\n        25% {transform: rotate(15deg);}\n        50% {transform: rotate(-15deg);}\n        75% {transform: rotate(15deg);}\n        100% {transform: rotate(0deg);}\n      }"}),(0,a.jsx)(i.xu,{alignItems:"center",display:"flex",dangerouslySetInlineStyle:{__style:p},height:40,justifyContent:"center",ref:e,width:40,children:"ðŸ˜ƒ"})]})})}},966476:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(667294);const r=()=>{const[e,t]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{t(!0)}),[]),e}},375571:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(667294),r=n(172071),s=n(395164);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class a extends o.Component{constructor(...e){super(...e),i(this,"state",{error:null,info:null}),i(this,"resetError",(()=>{this.setState({error:null,info:null})}))}componentDidCatch(e,t){try{var n;const t=this.props.name,o=this.props.type||"secondary";(0,s.T)({extraData:null!==(n=e.extraData)&&void 0!==n?n:{},errorBoundary:t,errorBoundaryType:o,message:e.message,name:e.name,stack:e.stack}),r.Z.increment("react.error_boundary",.1,{component:void 0,name:this.props.name})}catch(o){r.Z.increment("react.error_boundary.error",1,{name:this.props.name})}this.setState({error:e,info:t})}render(){const{renderErrorState:e}=this.props,{error:t,info:n}=this.state;return t&&n?e?e({error:t,info:n,resetError:this.resetError}):null:this.props.children}}},319915:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(375571).Z},720247:(e,t,n)=>{function o(e){let t=!1;return{promise:new Promise(((n,o)=>{e.then((e=>t?o({isCanceled:!0}):n(e)),(e=>o(t?{isCanceled:!0}:e)))})),cancel(){t=!0}}}n.d(t,{Z:()=>o})},995228:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(667294),r=n(966476),s=n(464228),i=n(785893);function a({children:e,fallback:t,dangerouslyServerRenderForGraphQL:n=!1}){const a=t||null,l=(0,r.Z)(),c=(0,s.P)();return c&&"legacy"!==c?n||l?(0,i.jsx)(o.Suspense,{fallback:a,children:e}):a:(0,i.jsx)(o.Suspense,{fallback:a,children:e})}},947599:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(995228).Z},342877:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(667294),r=n(720247);function s(){const e=(0,o.useRef)([]),t=(0,o.useRef)({});return(0,o.useEffect)((()=>()=>{[...Object.keys(t.current).map((e=>t.current[e])),...e.current].forEach((e=>e()))}),[]),function(n,o){if(o){const e=t.current[o];e&&(e(),delete t.current[o])}const{cancel:s,promise:i}=(0,r.Z)(n);return o?t.current[o]=s:e.current.push(s),i}}},400049:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A,mentionComponent:()=>P});var o=n(667294),r=n(846888),s=n(199324),i=n(672586),a=n(367216),l=n(319915),c=n(116303),u=n(898781),d=n(883119),p=n(785893);const _=e=>{const t=(0,u.ZP)(),{id:n,isFocused:o,onMouseDown:r,onMouseEnter:s,onMouseUp:i,mention:a,role:l,searchValue:_}=e;return(0,p.jsx)("div",{id:n,onMouseDown:r,onMouseEnter:s,onMouseUp:i,searchvalue:_,role:l,children:(0,p.jsxs)(d.xu,{display:"flex",alignItems:"center",color:o?"secondary":"transparent",rounding:4,dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},children:[(0,p.jsx)(d.xu,{padding:1,children:(0,p.jsx)(c.Z,{accessibilityLabel:"",name:a.full_name,size:"sm",src:a.image_medium_url,verified:a.verified_identity&&a.verified_identity.verified})}),(0,p.jsxs)(d.xu,{marginStart:2,marginEnd:2,overflow:"hidden",children:[(0,p.jsx)(d.xv,{lineClamp:1,weight:"bold",color:"default",children:a.full_name}),(0,p.jsx)(d.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"nowrap"}},children:(0,p.jsxs)(d.xv,{size:"100",color:"default",children:[a.username,a.explicitly_followed_by_me&&` â€¢ ${t._('Following', 'mentions.mentionsFlyout.following', 'Label to tell the user that they are viewing a user they follow')}`]})})]})]})})};var m=n(214494),y=n(947599),f=n(941646),g=n(342877),h=n(19121),x=n(235872),j=n(681477),S=n(909041);const v=(0,o.lazy)((()=>n.e(65047).then(n.bind(n,965047)))),b=new d.Ry(661),C=new d.H3([b]),P=e=>(0,p.jsx)(d.xv,{inline:!0,color:"shopping",weight:"bold",children:e.children});function A({cursor:e,editorRef:t,focusOnMount:n,hasEmojiEntryPoint:c=!0,initialMentions:b=[],initialText:A="",instanceId:E,isUiUpdated:w=!1,maxSuggestions:z=x.SF,onAddMention:Z,onBlur:k,onChange:M,onFocus:R,onPost:T,onSearchMentionCancel:L,onSuggestionsPopoverClose:D,onSuggestionsPopoverOpen:I,placeholder:F,readOnly:O,spellCheck:U,statusType:H}){const B=(0,u.ZP)(),{isAuth:G}=(0,h.Z)(),W=(0,o.useRef)(114),N=(0,o.useRef)(null),X=(0,o.useRef)(null),K=null!=t?t:X,J=(0,o.useRef)(null),[$,q]=(0,o.useState)(!1),[Q,V]=(0,o.useState)(!1),[Y,ee]=(0,o.useState)([]),[{plugins:te,MentionSuggestions:ne}]=(0,o.useState)((()=>(()=>{const e=(0,r.ZP)({entityMutability:"IMMUTABLE",mentionComponent:P,mentionPrefix:"@",mentionTrigger:"@",positionSuggestions:j.ou,supportWhitespace:!1}),{MentionSuggestions:t}=e;return{plugins:[e],MentionSuggestions:t}})())),oe=(0,g.Z)(),[re,se]=(0,o.useState)(!1),[ie,ae]=(0,o.useState)();(0,o.useEffect)((()=>{ae(S.EditorState.createWithContent((0,j.RL)({text:A,mentions:b})))}),[E]),(0,o.useEffect)((()=>{q(!0)}),[]),(0,o.useEffect)((()=>{n&&K.current&&setTimeout((()=>{var e;ae((e=>S.EditorState.moveSelectionToEnd(e))),null===(e=K.current)||void 0===e||e.focus()}),0)}),[$]);const le=null==ie?void 0:ie.getCurrentContent().getPlainText(""),ce=(0,o.useCallback)((e=>{ee([]),Z&&Z(e)}),[]),ue=(0,o.useCallback)((e=>{k&&k(e),se(!1)}),[]),de=(0,o.useCallback)((e=>{var t,n,o;const r=e.getCurrentContent(),s=r.getPlainText(""),i=(0,j.lX)(r);ae(e),M({text:s,mentions:i});const a=(null===(t=K.current)||void 0===t||null===(n=t.editor)||void 0===n||null===(o=n.editorContainer)||void 0===o?void 0:o.clientHeight)||0,l=N.current;a>114&&a>W.current&&l&&(l.scrollTop=l.scrollHeight,W.current=a)}),[]),pe=(0,o.useCallback)((()=>{R&&R()}),[]),_e=(0,o.useCallback)((()=>{V(!1),D&&D()}),[]),me=(0,o.useCallback)((()=>{V(!0),I&&I()}),[]),ye=(0,o.useCallback)(((e,t)=>{if(L&&" "===e&&Q&&L(),Y.length>0)return"not-handled";const n=t.getCurrentContent(),o=t.getSelection();return de(S.EditorState.push(t,S.Modifier.replaceText(n,o,e),"adjust-depth")),"handled"}),[Y]),fe=(0,o.useCallback)((({value:e})=>{oe(m.Z.create("UserMentionTypeaheadResource",{query:e,num_people:z}).callGet(),"userMentionTypeahead").then((e=>{const t=(0,j.OC)({suggestions:e.resource_response.data});ee(t)})).catch((()=>{}))}),[]);return(0,p.jsx)(l.Z,{name:"EditorWithMentions",children:$&&(0,p.jsxs)(d.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{fontFamily:s.Z}},"data-test-id":"editor-with-mentions",display:"flex",flex:"grow",minHeight:48,justifyContent:"between",width:"100%",children:[(0,p.jsx)(d.xu,{alignSelf:"textInFlightNested"===H?"start":"center",dangerouslySetInlineStyle:w?{__style:{cursor:e,paddingBottom:15,paddingLeft:"textStaticDisplay"===H?1:0,paddingTop:15}}:void 0,display:"flex",direction:"column",flex:"grow",marginStart:4,marginEnd:4,maxHeight:w?146:void 0,overflow:w?"auto":void 0,paddingX:w?0:1,ref:N,children:(0,p.jsx)(i.ZP,{ariaLabel:F,editorState:ie,onBlur:ue,onChange:de,onFocus:pe,handleBeforeInput:ye,placeholder:F,plugins:te,readOnly:O,ref:K,spellCheck:U,stripPastedStyles:!0})}),(0,p.jsx)(d.xu,{dangerouslySetInlineStyle:w?{__style:{paddingBottom:"textStaticDisplay"===H?6:5,paddingRight:"textStaticDisplay"===H?6:5,paddingTop:"textStaticDisplay"===H?6:5}}:void 0,children:w&&T&&le?(0,p.jsx)(f.Z,{id:"activity-item-create-submit",children:(0,p.jsx)(d.hU,{accessibilityLabel:B._('post', 'comment.composer.post', 'comment post button'),bgColor:"red",icon:"send",onClick:()=>{(async()=>{T&&await T()&&ae(S.EditorState.createWithContent((0,j.RL)({text:"",mentions:[]})))})()},size:"md"})}):c&&(0,p.jsx)(a.Z,{isEmojiTrayOpen:re,onClick:()=>{G?se(!re):pe()},entryPointRef:J})}),(0,p.jsx)(ne,{onAddMention:ce,onClose:_e,onOpen:me,onSearchChange:fe,suggestions:Y,entryComponent:_}),re&&!!J&&(0,p.jsx)(y.Z,{children:(0,p.jsx)(d.mh,{zIndex:C,children:(0,p.jsx)(d.J2,{anchor:J.current,onDismiss:()=>{se(!1)},idealDirection:"up",size:"lg",showCaret:!0,positionRelativeToAnchor:!1,children:(0,p.jsx)(v,{onEmojiClick:e=>{if(ie){const t=ie.getCurrentContent(),n=ie.getSelection();de(S.EditorState.push(ie,S.Modifier.replaceText(t,n,e.emoji),"adjust-depth")),se(!re),pe()}},categories:[{category:"suggested",recently_used:B._('Recently Used', 'emojitray.group.recently_used', 'Group name for emoji tray for recently used emojis')},{category:"smileys_people",name:B._('Smileys & People', 'emojitray.group.smileys_people', 'Group name for emoji tray for smiley and people emojis')},{category:"animals_nature",name:B._('Animals & Nature', 'emojitray.group.animals_nature', 'Group name for emoji tray for animals and nature emojis')},{category:"food_drink",name:B._('Food & Drink', 'emojitray.group.food_drink', 'Group name for emoji tray for food and drink emojis')},{category:"travel_places",name:B._('Travel & Places', 'emojitray.group.travel_places', 'Group name for emoji tray for travel and places emojis')},{category:"activities",name:B._('Activities', 'emojitray.group.activities', 'Group name for emoji tray for activities emojis')},{category:"objects",name:B._('Objects', 'emojitray.group.objects', 'Group name for emoji tray for objects emojis')},{category:"symbols",name:B._('Symbols', 'emojitray.group.symbols', 'Group name for emoji tray for symbols emojis')},{category:"flags",name:B._('Flags', 'emojitray.group.flags', 'Group name for emoji tray for flags emojis')}]})})})})]})})}},235872:(e,t,n)=>{n.d(t,{N:()=>a,SF:()=>o,XN:()=>c,XU:()=>s,b7:()=>r,fL:()=>l,z5:()=>i});const o=5,r=5,s=1,i="var(--color-border-container)",a="var(--color-border-error)",l="var(--color-gray-roboflow-400)",c="4px solid #0084ff80"},681477:(e,t,n)=>{n.d(t,{OC:()=>u,RL:()=>l,lX:()=>c,ou:()=>d});var o=n(578510),r=n(883119),s=n(909041),i=n(121151),a=n(235872);const l=({text:e,mentions:t})=>{const n=[],o={},r=[];t&&t.forEach(((e,t)=>{const{length:n,offset:s,object_id:i}=e;o[t]={data:{mention:{id:i}},mutability:"IMMUTABLE",type:"mention"},r.push({key:t,length:n,offset:s})})),n.push({text:e,key:null,depth:null,inlineStyleRanges:null,type:"unstyled",entityRanges:r});return(0,s.convertFromRaw)({entityMap:o,blocks:n})},c=e=>{const t=[];let n=0;return e.getBlocksAsArray().forEach(((o,r)=>{let s=null;o.findEntityRanges((t=>{const n=t.getEntity();if(!n)return!1;const o=e.getEntity(n);return"mention"===o.getType()&&(s=o.data.mention,!0)}),((e,o)=>{s&&t.push({object_id:s.id,offset:n+e,length:o-e,tag_type:a.XU})})),n+=1+o.getLength()})),t},u=({suggestions:e})=>e.map((e=>({...e,name:e.username}))),d=({decoratorRect:e,popover:t,state:n,props:s,...a})=>{const l=(e.x||e.left)+t.offsetWidth,c=(e.y||e.top)+t.offsetHeight,{top:u,left:d}=(0,o.default)({decoratorRect:e,popover:t,state:n,props:s});let p=null;l>window.innerWidth&&(p=parseFloat(d)-l%window.innerWidth+"px");let _="",m=`${parseFloat(u)+5}px`;return c>window.innerHeight&&(_="translateY(-100%)",m=parseFloat(u)-20+"px"),{display:"block",top:m,left:p||d,zIndex:new r.H3([i.b7]).index(),transform:_}}},464228:(e,t,n)=>{n.d(t,{P:()=>s,Z:()=>i});var o=n(667294);const r=(0,o.createContext)();function s(){return(0,o.useContext)(r)}const i=r}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/EditorWithMentionsInternal-bc24e3d40f9e2ed4.mjs.map